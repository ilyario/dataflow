
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Kubernetes operator for data flow between different sources">
      
      
        <meta name="author" content="DataFlow Team">
      
      
      
        <link rel="prev" href="../getting-started/">
      
      
        <link rel="next" href="../transformations/">
      
      
        
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Коннекторы - DataFlow Operator Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="blue">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#connectors" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="DataFlow Operator Documentation" class="md-header__button md-logo" aria-label="DataFlow Operator Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            DataFlow Operator Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Коннекторы
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="blue"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="blue" data-md-color-accent="blue"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../en/" class="md-tabs__link">
          
  
  
  English

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
  
  Русский

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="DataFlow Operator Documentation" class="md-nav__button md-logo" aria-label="DataFlow Operator Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    DataFlow Operator Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    English
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    English
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../en/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../en/getting-started/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Getting Started
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../en/connectors/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Connectors
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../en/transformations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Transformations
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../en/examples/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Examples
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../en/development/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Development
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Русский
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Русский
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Главная
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Начало работы
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Коннекторы
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Коннекторы
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Обзор коннекторов
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kafka" class="md-nav__link">
    <span class="md-ellipsis">
      
        Kafka
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Kafka">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#source" class="md-nav__link">
    <span class="md-ellipsis">
      
        Источник (Source)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Источник (Source)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kafka_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Особенности Kafka источника
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tls-sasl" class="md-nav__link">
    <span class="md-ellipsis">
      
        Пример с TLS и SASL
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sink" class="md-nav__link">
    <span class="md-ellipsis">
      
        Приемник (Sink)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Приемник (Sink)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kafka_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        Особенности Kafka приемника
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#postgresql" class="md-nav__link">
    <span class="md-ellipsis">
      
        PostgreSQL
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PostgreSQL">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#source_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Источник (Source)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Источник (Source)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#postgresql_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Особенности PostgreSQL источника
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        Пример с кастомным запросом
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sink_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Приемник (Sink)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Приемник (Sink)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#postgresql_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        Особенности PostgreSQL приемника
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      
        Пример с автосозданием таблицы
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rabbitmq" class="md-nav__link">
    <span class="md-ellipsis">
      
        RabbitMQ
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="RabbitMQ">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#source_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        Источник (Source)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Источник (Source)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rabbitmq_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Особенности RabbitMQ источника
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exchange-routing-key" class="md-nav__link">
    <span class="md-ellipsis">
      
        Пример с exchange и routing key
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sink_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        Приемник (Sink)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Приемник (Sink)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rabbitmq_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        Особенности RabbitMQ приемника
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#routing-key" class="md-nav__link">
    <span class="md-ellipsis">
      
        Пример с динамическим routing key
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iceberg" class="md-nav__link">
    <span class="md-ellipsis">
      
        Iceberg
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Iceberg">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#source_3" class="md-nav__link">
    <span class="md-ellipsis">
      
        Источник (Source)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Источник (Source)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#iceberg_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Особенности Iceberg источника
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      
        Требования для работы
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sink_3" class="md-nav__link">
    <span class="md-ellipsis">
      
        Приемник (Sink)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Приемник (Sink)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#iceberg_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        Особенности Iceberg приемника
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      
        Пример с автосозданием
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#secrets-kubernetes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Использование Secrets в Kubernetes
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Использование Secrets в Kubernetes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      
        Обзор
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#secretref" class="md-nav__link">
    <span class="md-ellipsis">
      
        Структура SecretRef
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      
        Поддерживаемые поля
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Поддерживаемые поля">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kafka_3" class="md-nav__link">
    <span class="md-ellipsis">
      
        Kafka
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#postgresql_3" class="md-nav__link">
    <span class="md-ellipsis">
      
        PostgreSQL
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iceberg_3" class="md-nav__link">
    <span class="md-ellipsis">
      
        Iceberg
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rabbitmq_3" class="md-nav__link">
    <span class="md-ellipsis">
      
        RabbitMQ
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      
        Примеры использования
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Примеры использования">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-kafka-sasl" class="md-nav__link">
    <span class="md-ellipsis">
      
        Пример 1: Kafka с SASL аутентификацией
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-postgresql-connection-string-secret" class="md-nav__link">
    <span class="md-ellipsis">
      
        Пример 2: PostgreSQL с connection string из secret
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-kafka-postgresql-secrets" class="md-nav__link">
    <span class="md-ellipsis">
      
        Пример 3: Kafka → PostgreSQL с secrets
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-tls-secrets" class="md-nav__link">
    <span class="md-ellipsis">
      
        Пример 4: TLS сертификаты из secrets
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    <span class="md-ellipsis">
      
        Приоритет значений
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#secrets-namespace" class="md-nav__link">
    <span class="md-ellipsis">
      
        Secrets в разных namespace
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    <span class="md-ellipsis">
      
        Безопасность
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    <span class="md-ellipsis">
      
        Устранение неполадок
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Устранение неполадок">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#secret" class="md-nav__link">
    <span class="md-ellipsis">
      
        Secret не найден
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#secret_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Ключ не найден в secret
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#secrets" class="md-nav__link">
    <span class="md-ellipsis">
      
        Ошибка разрешения secrets
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    <span class="md-ellipsis">
      
        Рекомендации по производительности
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Рекомендации по производительности">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kafka_4" class="md-nav__link">
    <span class="md-ellipsis">
      
        Kafka
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#postgresql_4" class="md-nav__link">
    <span class="md-ellipsis">
      
        PostgreSQL
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rabbitmq_4" class="md-nav__link">
    <span class="md-ellipsis">
      
        RabbitMQ
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iceberg_4" class="md-nav__link">
    <span class="md-ellipsis">
      
        Iceberg
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    <span class="md-ellipsis">
      
        Устранение неполадок
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Устранение неполадок">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    <span class="md-ellipsis">
      
        Проблемы с подключением
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_15" class="md-nav__link">
    <span class="md-ellipsis">
      
        Проблемы с производительностью
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_16" class="md-nav__link">
    <span class="md-ellipsis">
      
        Логирование
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../transformations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Трансформации
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Примеры
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../development/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Разработка
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="connectors">Connectors</h1>
<p>DataFlow Operator поддерживает различные коннекторы для источников и приемников данных. Каждый коннектор реализует стандартный интерфейс и может использоваться как источник (source) или приемник (sink) данных.</p>
<h2 id="_1">Обзор коннекторов</h2>
<table>
<thead>
<tr>
<th>Коннектор</th>
<th>Источник</th>
<th>Приемник</th>
<th>Особенности</th>
</tr>
</thead>
<tbody>
<tr>
<td>Kafka</td>
<td>✅</td>
<td>✅</td>
<td>Consumer groups, TLS, SASL</td>
</tr>
<tr>
<td>PostgreSQL</td>
<td>✅</td>
<td>✅</td>
<td>SQL запросы, батч-вставки, автосоздание таблиц</td>
</tr>
<tr>
<td>RabbitMQ</td>
<td>✅</td>
<td>✅</td>
<td>Exchanges, routing keys, очереди</td>
</tr>
<tr>
<td>Iceberg</td>
<td>✅</td>
<td>✅</td>
<td>REST API, автосоздание namespace/таблиц</td>
</tr>
</tbody>
</table>
<h2 id="kafka">Kafka</h2>
<p>Kafka коннектор поддерживает чтение и запись сообщений из/в топики Apache Kafka. Поддерживает consumer groups для масштабирования, TLS и SASL аутентификацию.</p>
<h3 id="source">Источник (Source)</h3>
<p>Конфигурация Kafka источника:</p>
<div class="highlight"><pre><span></span><code><span class="nt">source</span><span class="p">:</span>
<span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kafka</span>
<span class="w">  </span><span class="nt">kafka</span><span class="p">:</span>
<span class="w">    </span><span class="c1"># Список брокеров Kafka (обязательно)</span>
<span class="w">    </span><span class="nt">brokers</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kafka1:9092</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kafka2:9092</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kafka3:9092</span>

<span class="w">    </span><span class="c1"># Топик для чтения (обязательно)</span>
<span class="w">    </span><span class="nt">topic</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">input-topic</span>

<span class="w">    </span><span class="c1"># Consumer group (опционально, по умолчанию: dataflow-operator)</span>
<span class="w">    </span><span class="nt">consumerGroup</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my-group</span>

<span class="w">    </span><span class="c1"># TLS конфигурация (опционально)</span>
<span class="w">    </span><span class="nt">tls</span><span class="p">:</span>
<span class="w">      </span><span class="c1"># Пропустить проверку сертификата (не рекомендуется для production)</span>
<span class="w">      </span><span class="nt">insecureSkipVerify</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">      </span><span class="c1"># Путь к CA сертификату</span>
<span class="w">      </span><span class="nt">caFile</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/path/to/ca.crt</span>
<span class="w">      </span><span class="c1"># Путь к клиентскому сертификату</span>
<span class="w">      </span><span class="nt">certFile</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/path/to/client.crt</span>
<span class="w">      </span><span class="c1"># Путь к приватному ключу</span>
<span class="w">      </span><span class="nt">keyFile</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/path/to/client.key</span>

<span class="w">    </span><span class="c1"># SASL аутентификация (опционально)</span>
<span class="w">    </span><span class="nt">sasl</span><span class="p">:</span>
<span class="w">      </span><span class="c1"># Механизм: plain, scram-sha-256, scram-sha-512</span>
<span class="w">      </span><span class="nt">mechanism</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">scram-sha-256</span>
<span class="w">      </span><span class="nt">username</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kafka-user</span>
<span class="w">      </span><span class="nt">password</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kafka-password</span>
</code></pre></div>
<h4 id="kafka_1">Особенности Kafka источника</h4>
<ul>
<li><strong>Consumer Groups</strong>: Используйте разные consumer groups для масштабирования обработки</li>
<li><strong>Начальная позиция</strong>: По умолчанию читает с самого старого сообщения (<code>OffsetOldest</code>)</li>
<li><strong>Метаданные</strong>: Каждое сообщение содержит метаданные:</li>
<li><code>topic</code> - название топика</li>
<li><code>partition</code> - номер партиции</li>
<li><code>offset</code> - смещение сообщения</li>
<li><code>key</code> - ключ сообщения (если есть)</li>
</ul>
<h4 id="tls-sasl">Пример с TLS и SASL</h4>
<div class="highlight"><pre><span></span><code><span class="nt">source</span><span class="p">:</span>
<span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kafka</span>
<span class="w">  </span><span class="nt">kafka</span><span class="p">:</span>
<span class="w">    </span><span class="nt">brokers</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">secure-kafka:9093</span>
<span class="w">    </span><span class="nt">topic</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">secure-topic</span>
<span class="w">    </span><span class="nt">consumerGroup</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">secure-group</span>
<span class="w">    </span><span class="nt">tls</span><span class="p">:</span>
<span class="w">      </span><span class="nt">caFile</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/etc/kafka/ca.crt</span>
<span class="w">      </span><span class="nt">certFile</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/etc/kafka/client.crt</span>
<span class="w">      </span><span class="nt">keyFile</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/etc/kafka/client.key</span>
<span class="w">    </span><span class="nt">sasl</span><span class="p">:</span>
<span class="w">      </span><span class="nt">mechanism</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">scram-sha-512</span>
<span class="w">      </span><span class="nt">username</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kafka-user</span>
<span class="w">      </span><span class="nt">password</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${KAFKA_PASSWORD}</span><span class="w">  </span><span class="c1"># Используйте Secrets в Kubernetes</span>
</code></pre></div>
<h3 id="sink">Приемник (Sink)</h3>
<p>Конфигурация Kafka приемника:</p>
<div class="highlight"><pre><span></span><code><span class="nt">sink</span><span class="p">:</span>
<span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kafka</span>
<span class="w">  </span><span class="nt">kafka</span><span class="p">:</span>
<span class="w">    </span><span class="c1"># Список брокеров Kafka (обязательно)</span>
<span class="w">    </span><span class="nt">brokers</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kafka1:9092</span>

<span class="w">    </span><span class="c1"># Топик для записи (обязательно)</span>
<span class="w">    </span><span class="nt">topic</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">output-topic</span>

<span class="w">    </span><span class="c1"># TLS конфигурация (опционально, аналогично источнику)</span>
<span class="w">    </span><span class="nt">tls</span><span class="p">:</span>
<span class="w">      </span><span class="nt">caFile</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/path/to/ca.crt</span>
<span class="w">      </span><span class="nt">certFile</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/path/to/client.crt</span>
<span class="w">      </span><span class="nt">keyFile</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/path/to/client.key</span>

<span class="w">    </span><span class="c1"># SASL конфигурация (опционально, аналогично источнику)</span>
<span class="w">    </span><span class="nt">sasl</span><span class="p">:</span>
<span class="w">      </span><span class="nt">mechanism</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">scram-sha-256</span>
<span class="w">      </span><span class="nt">username</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kafka-user</span>
<span class="w">      </span><span class="nt">password</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kafka-password</span>
</code></pre></div>
<h4 id="kafka_2">Особенности Kafka приемника</h4>
<ul>
<li><strong>Синхронная запись</strong>: Использует <code>SyncProducer</code> для гарантированной доставки</li>
<li><strong>Ключи сообщений</strong>: Сохраняет ключи из метаданных сообщения</li>
<li><strong>Метаданные</strong>: После записи обновляет метаданные с <code>partition</code> и <code>offset</code></li>
</ul>
<h2 id="postgresql">PostgreSQL</h2>
<p>PostgreSQL коннектор поддерживает чтение из таблиц и запись в таблицы PostgreSQL. Поддерживает кастомные SQL запросы, периодический опрос и батч-вставки.</p>
<h3 id="source_1">Источник (Source)</h3>
<p>Конфигурация PostgreSQL источника:</p>
<div class="highlight"><pre><span></span><code><span class="nt">source</span><span class="p">:</span>
<span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">postgresql</span>
<span class="w">  </span><span class="nt">postgresql</span><span class="p">:</span>
<span class="w">    </span><span class="c1"># Connection string (обязательно)</span>
<span class="w">    </span><span class="c1"># Формат: postgres://user:password@host:port/dbname?sslmode=mode</span>
<span class="w">    </span><span class="nt">connectionString</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;postgres://user:password@localhost:5432/dbname?sslmode=disable&quot;</span>

<span class="w">    </span><span class="c1"># Таблица для чтения (обязательно, если не указан query)</span>
<span class="w">    </span><span class="nt">table</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">source_table</span>

<span class="w">    </span><span class="c1"># Кастомный SQL запрос (опционально)</span>
<span class="w">    </span><span class="c1"># Если указан, используется вместо чтения всей таблицы</span>
<span class="w">    </span><span class="nt">query</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;SELECT</span><span class="nv"> </span><span class="s">*</span><span class="nv"> </span><span class="s">FROM</span><span class="nv"> </span><span class="s">source_table</span><span class="nv"> </span><span class="s">WHERE</span><span class="nv"> </span><span class="s">updated_at</span><span class="nv"> </span><span class="s">&gt;</span><span class="nv"> </span><span class="s">NOW()</span><span class="nv"> </span><span class="s">-</span><span class="nv"> </span><span class="s">INTERVAL</span><span class="nv"> </span><span class="s">&#39;1</span><span class="nv"> </span><span class="s">hour&#39;&quot;</span>

<span class="w">    </span><span class="c1"># Интервал опроса в секундах (опционально, по умолчанию: 5)</span>
<span class="w">    </span><span class="c1"># Используется для периодического чтения новых данных</span>
<span class="w">    </span><span class="nt">pollInterval</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">60</span>
</code></pre></div>
<h4 id="postgresql_1">Особенности PostgreSQL источника</h4>
<ul>
<li><strong>Периодический опрос</strong>: Регулярно опрашивает таблицу на наличие новых данных</li>
<li><strong>Кастомные запросы</strong>: Поддержка сложных SQL запросов с JOIN, WHERE, и т.д.</li>
<li><strong>Метаданные</strong>: Каждое сообщение содержит метаданные:</li>
<li><code>table</code> - название таблицы</li>
<li><strong>Формат данных</strong>: Данные преобразуются в JSON формат</li>
</ul>
<h4 id="_2">Пример с кастомным запросом</h4>
<div class="highlight"><pre><span></span><code><span class="nt">source</span><span class="p">:</span>
<span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">postgresql</span>
<span class="w">  </span><span class="nt">postgresql</span><span class="p">:</span>
<span class="w">    </span><span class="nt">connectionString</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;postgres://user:password@localhost:5432/analytics&quot;</span>
<span class="w">    </span><span class="nt">query</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">      </span><span class="no">SELECT</span>
<span class="w">        </span><span class="no">u.id,</span>
<span class="w">        </span><span class="no">u.email,</span>
<span class="w">        </span><span class="no">o.order_id,</span>
<span class="w">        </span><span class="no">o.total</span>
<span class="w">      </span><span class="no">FROM users u</span>
<span class="w">      </span><span class="no">JOIN orders o ON u.id = o.user_id</span>
<span class="w">      </span><span class="no">WHERE o.created_at &gt; NOW() - INTERVAL &#39;1 day&#39;</span>
<span class="w">    </span><span class="nt">pollInterval</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">300</span><span class="w">  </span><span class="c1"># Опрос каждые 5 минут</span>
</code></pre></div>
<h3 id="sink_1">Приемник (Sink)</h3>
<p>Конфигурация PostgreSQL приемника:</p>
<div class="highlight"><pre><span></span><code><span class="nt">sink</span><span class="p">:</span>
<span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">postgresql</span>
<span class="w">  </span><span class="nt">postgresql</span><span class="p">:</span>
<span class="w">    </span><span class="c1"># Connection string (обязательно)</span>
<span class="w">    </span><span class="nt">connectionString</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;postgres://user:password@localhost:5432/dbname?sslmode=disable&quot;</span>

<span class="w">    </span><span class="c1"># Таблица для записи (обязательно)</span>
<span class="w">    </span><span class="nt">table</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">target_table</span>

<span class="w">    </span><span class="c1"># Размер батча для вставки (опционально, по умолчанию: 1)</span>
<span class="w">    </span><span class="c1"># Увеличьте для повышения производительности</span>
<span class="w">    </span><span class="nt">batchSize</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100</span>

<span class="w">    </span><span class="c1"># Автоматическое создание таблицы (опционально, по умолчанию: false)</span>
<span class="w">    </span><span class="c1"># Если true, создает таблицу с JSONB полем для гибкой схемы</span>
<span class="w">    </span><span class="nt">autoCreateTable</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</code></pre></div>
<h4 id="postgresql_2">Особенности PostgreSQL приемника</h4>
<ul>
<li><strong>Батч-вставки</strong>: Группирует сообщения для эффективной записи</li>
<li><strong>Автосоздание таблиц</strong>: Автоматически создает таблицы с JSONB полем</li>
<li><strong>Гибкая схема</strong>: Поддерживает как JSONB (для автосозданных таблиц), так и колоночный формат</li>
<li><strong>Индексы</strong>: Автоматически создает GIN индекс на JSONB поле для быстрого поиска</li>
</ul>
<h4 id="_3">Пример с автосозданием таблицы</h4>
<div class="highlight"><pre><span></span><code><span class="nt">sink</span><span class="p">:</span>
<span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">postgresql</span>
<span class="w">  </span><span class="nt">postgresql</span><span class="p">:</span>
<span class="w">    </span><span class="nt">connectionString</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;postgres://user:password@localhost:5432/analytics&quot;</span>
<span class="w">    </span><span class="nt">table</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">events</span>
<span class="w">    </span><span class="nt">autoCreateTable</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span><span class="w">  </span><span class="c1"># Создаст таблицу с JSONB полем</span>
<span class="w">    </span><span class="nt">batchSize</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">50</span>
</code></pre></div>
<p>Автоматически созданная таблица будет иметь структуру:</p>
<div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">events</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="nb">SERIAL</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
<span class="w">    </span><span class="k">data</span><span class="w"> </span><span class="n">JSONB</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="n">created_at</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">CURRENT_TIMESTAMP</span>
<span class="p">);</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_events_data</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">events</span><span class="w"> </span><span class="k">USING</span><span class="w"> </span><span class="n">GIN</span><span class="w"> </span><span class="p">(</span><span class="k">data</span><span class="p">);</span>
</code></pre></div>
<h2 id="rabbitmq">RabbitMQ</h2>
<p>RabbitMQ коннектор поддерживает чтение из очередей и публикацию в очереди RabbitMQ. Поддерживает exchanges, routing keys и прямую публикацию в очереди.</p>
<h3 id="source_2">Источник (Source)</h3>
<p>Конфигурация RabbitMQ источника:</p>
<div class="highlight"><pre><span></span><code><span class="nt">source</span><span class="p">:</span>
<span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rabbitmq</span>
<span class="w">  </span><span class="nt">rabbitmq</span><span class="p">:</span>
<span class="w">    </span><span class="c1"># URL подключения (обязательно)</span>
<span class="w">    </span><span class="c1"># Формат: amqp://user:password@host:port/vhost</span>
<span class="w">    </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;amqp://guest:guest@localhost:5672/&quot;</span>

<span class="w">    </span><span class="c1"># Очередь для чтения (обязательно)</span>
<span class="w">    </span><span class="nt">queue</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">input-queue</span>

<span class="w">    </span><span class="c1"># Exchange для привязки очереди (опционально)</span>
<span class="w">    </span><span class="nt">exchange</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">input-exchange</span>

<span class="w">    </span><span class="c1"># Routing key для привязки (опционально, требуется если указан exchange)</span>
<span class="w">    </span><span class="nt">routingKey</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">input.key</span>
</code></pre></div>
<h4 id="rabbitmq_1">Особенности RabbitMQ источника</h4>
<ul>
<li><strong>Автоматическое объявление</strong>: Автоматически объявляет очередь, если она не существует</li>
<li><strong>Привязка к exchange</strong>: Автоматически привязывает очередь к exchange, если указан</li>
<li><strong>Подтверждение доставки</strong>: Использует ручное подтверждение (manual ack) для надежности</li>
<li><strong>Метаданные</strong>: Каждое сообщение содержит:</li>
<li><code>exchange</code> - название exchange</li>
<li><code>routingKey</code> - routing key сообщения</li>
<li><code>deliveryTag</code> - тег доставки</li>
</ul>
<h4 id="exchange-routing-key">Пример с exchange и routing key</h4>
<div class="highlight"><pre><span></span><code><span class="nt">source</span><span class="p">:</span>
<span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rabbitmq</span>
<span class="w">  </span><span class="nt">rabbitmq</span><span class="p">:</span>
<span class="w">    </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;amqp://user:password@rabbitmq:5672/vhost&quot;</span>
<span class="w">    </span><span class="nt">queue</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">events-queue</span>
<span class="w">    </span><span class="nt">exchange</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">events-exchange</span>
<span class="w">    </span><span class="nt">routingKey</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">events.*</span><span class="w">  </span><span class="c1"># Поддержка wildcards</span>
</code></pre></div>
<h3 id="sink_2">Приемник (Sink)</h3>
<p>Конфигурация RabbitMQ приемника:</p>
<div class="highlight"><pre><span></span><code><span class="nt">sink</span><span class="p">:</span>
<span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rabbitmq</span>
<span class="w">  </span><span class="nt">rabbitmq</span><span class="p">:</span>
<span class="w">    </span><span class="c1"># URL подключения (обязательно)</span>
<span class="w">    </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;amqp://guest:guest@localhost:5672/&quot;</span>

<span class="w">    </span><span class="c1"># Exchange для публикации (обязательно)</span>
<span class="w">    </span><span class="nt">exchange</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">output-exchange</span>

<span class="w">    </span><span class="c1"># Routing key (обязательно)</span>
<span class="w">    </span><span class="nt">routingKey</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">output.key</span>

<span class="w">    </span><span class="c1"># Прямая публикация в очередь (опционально)</span>
<span class="w">    </span><span class="c1"># Если указан, сообщения публикуются напрямую в очередь, минуя exchange</span>
<span class="w">    </span><span class="nt">queue</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">output-queue</span>
</code></pre></div>
<h4 id="rabbitmq_2">Особенности RabbitMQ приемника</h4>
<ul>
<li><strong>Автоматическое объявление exchange</strong>: Автоматически объявляет exchange типа <code>topic</code></li>
<li><strong>Динамический routing key</strong>: Может использовать routing key из метаданных сообщения</li>
<li><strong>Надежная доставка</strong>: Использует persistent messages для надежности</li>
</ul>
<h4 id="routing-key">Пример с динамическим routing key</h4>
<p>Если сообщение содержит метаданные <code>routingKey</code>, оно будет использовано вместо указанного в конфигурации:</p>
<div class="highlight"><pre><span></span><code><span class="nt">sink</span><span class="p">:</span>
<span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rabbitmq</span>
<span class="w">  </span><span class="nt">rabbitmq</span><span class="p">:</span>
<span class="w">    </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;amqp://user:password@rabbitmq:5672/&quot;</span>
<span class="w">    </span><span class="nt">exchange</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">events-exchange</span>
<span class="w">    </span><span class="nt">routingKey</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default.key</span><span class="w">  </span><span class="c1"># Используется, если нет в метаданных</span>
</code></pre></div>
<h2 id="iceberg">Iceberg</h2>
<p>Iceberg коннектор работает с Apache Iceberg через REST API. Оптимизирован для работы с большими данными и поддерживает автоматическое создание namespace и таблиц.</p>
<h3 id="source_3">Источник (Source)</h3>
<p>Конфигурация Iceberg источника:</p>
<div class="highlight"><pre><span></span><code><span class="nt">source</span><span class="p">:</span>
<span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">iceberg</span>
<span class="w">  </span><span class="nt">iceberg</span><span class="p">:</span>
<span class="w">    </span><span class="c1"># URL REST Catalog (обязательно)</span>
<span class="w">    </span><span class="nt">restCatalogUrl</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;http://iceberg-rest:8181&quot;</span>

<span class="w">    </span><span class="c1"># Namespace в каталоге (обязательно)</span>
<span class="w">    </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">analytics</span>

<span class="w">    </span><span class="c1"># Название таблицы (обязательно)</span>
<span class="w">    </span><span class="nt">table</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">source_table</span>

<span class="w">    </span><span class="c1"># Токен аутентификации (опционально)</span>
<span class="w">    </span><span class="nt">token</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;your-auth-token&quot;</span>
</code></pre></div>
<h4 id="iceberg_1">Особенности Iceberg источника</h4>
<ul>
<li><strong>Стриминг чтение</strong>: Использует Arrow RecordBatches для эффективного чтения</li>
<li><strong>Поддержка типов</strong>: Автоматически обрабатывает различные типы данных Iceberg</li>
<li><strong>Метаданные</strong>: Каждое сообщение содержит:</li>
<li><code>namespace</code> - namespace таблицы</li>
<li><code>table</code> - название таблицы</li>
</ul>
<h4 id="_4">Требования для работы</h4>
<p>Для работы Iceberg коннектора необходимо настроить переменные окружения для доступа к объектному хранилищу (S3/MinIO):</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">AWS_REGION</span><span class="o">=</span>us-east-1
<span class="nb">export</span><span class="w"> </span><span class="nv">AWS_ACCESS_KEY_ID</span><span class="o">=</span>admin
<span class="nb">export</span><span class="w"> </span><span class="nv">AWS_SECRET_ACCESS_KEY</span><span class="o">=</span>password
<span class="nb">export</span><span class="w"> </span><span class="nv">AWS_ENDPOINT_URL_S3</span><span class="o">=</span>http://localhost:9000<span class="w">  </span><span class="c1"># Для MinIO</span>
</code></pre></div>
<h3 id="sink_3">Приемник (Sink)</h3>
<p>Конфигурация Iceberg приемника:</p>
<div class="highlight"><pre><span></span><code><span class="nt">sink</span><span class="p">:</span>
<span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">iceberg</span>
<span class="w">  </span><span class="nt">iceberg</span><span class="p">:</span>
<span class="w">    </span><span class="c1"># URL REST Catalog (обязательно)</span>
<span class="w">    </span><span class="nt">restCatalogUrl</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;http://iceberg-rest:8181&quot;</span>

<span class="w">    </span><span class="c1"># Namespace в каталоге (обязательно)</span>
<span class="w">    </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">analytics</span>

<span class="w">    </span><span class="c1"># Название таблицы (обязательно)</span>
<span class="w">    </span><span class="nt">table</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">target_table</span>

<span class="w">    </span><span class="c1"># Токен аутентификации (опционально)</span>
<span class="w">    </span><span class="nt">token</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;your-auth-token&quot;</span>

<span class="w">    </span><span class="c1"># Автоматическое создание namespace (опционально, по умолчанию: true)</span>
<span class="w">    </span><span class="nt">autoCreateNamespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>

<span class="w">    </span><span class="c1"># Автоматическое создание таблицы (опционально, по умолчанию: false)</span>
<span class="w">    </span><span class="c1"># Если true, создает таблицу с полем &quot;data&quot; типа String</span>
<span class="w">    </span><span class="nt">autoCreateTable</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</code></pre></div>
<h4 id="iceberg_2">Особенности Iceberg приемника</h4>
<ul>
<li><strong>Батч-запись</strong>: Группирует сообщения в батчи для эффективной записи</li>
<li><strong>Автосоздание</strong>: Автоматически создает namespace и таблицы при необходимости</li>
<li><strong>Обработка конфликтов</strong>: Автоматически обрабатывает конфликты при параллельных записях</li>
<li><strong>Arrow формат</strong>: Использует Apache Arrow для эффективной сериализации данных</li>
</ul>
<h4 id="_5">Пример с автосозданием</h4>
<div class="highlight"><pre><span></span><code><span class="nt">sink</span><span class="p">:</span>
<span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">iceberg</span>
<span class="w">  </span><span class="nt">iceberg</span><span class="p">:</span>
<span class="w">    </span><span class="nt">restCatalogUrl</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;http://iceberg-rest:8181&quot;</span>
<span class="w">    </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">analytics</span>
<span class="w">    </span><span class="nt">table</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">events</span>
<span class="w">    </span><span class="nt">token</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;${ICEBERG_TOKEN}&quot;</span>
<span class="w">    </span><span class="nt">autoCreateNamespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">autoCreateTable</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</code></pre></div>
<p>Автоматически созданная таблица будет иметь схему с полем <code>data</code> типа <code>String</code>, в котором хранится JSON представление сообщения.</p>
<h2 id="secrets-kubernetes">Использование Secrets в Kubernetes</h2>
<p>DataFlow Operator поддерживает конфигурацию коннекторов из Kubernetes Secrets. Это позволяет безопасно хранить чувствительные данные (пароли, токены, connection strings) без их явного указания в спецификации DataFlow.</p>
<h3 id="_6">Обзор</h3>
<p>Вместо указания значений напрямую в конфигурации, вы можете использовать ссылки на Kubernetes Secrets через поля <code>*SecretRef</code>. Оператор автоматически читает значения из secrets и подставляет их в конфигурацию коннекторов.</p>
<h3 id="secretref">Структура SecretRef</h3>
<p>Каждая ссылка на secret имеет следующую структуру:</p>
<div class="highlight"><pre><span></span><code><span class="nt">secretRef</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my-secret</span><span class="w">          </span><span class="c1"># Имя secret (обязательно)</span>
<span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my-namespace</span><span class="w">  </span><span class="c1"># Namespace secret (опционально, по умолчанию - namespace DataFlow)</span>
<span class="w">  </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my-key</span><span class="w">              </span><span class="c1"># Ключ в secret (обязательно)</span>
</code></pre></div>
<h3 id="_7">Поддерживаемые поля</h3>
<p>Все коннекторы поддерживают ссылки на secrets для следующих полей:</p>
<h4 id="kafka_3">Kafka</h4>
<ul>
<li><code>brokersSecretRef</code> - список брокеров (через запятую)</li>
<li><code>topicSecretRef</code> - название топика</li>
<li><code>consumerGroupSecretRef</code> - consumer group</li>
<li><code>sasl.usernameSecretRef</code> - имя пользователя SASL</li>
<li><code>sasl.passwordSecretRef</code> - пароль SASL</li>
<li><code>tls.certSecretRef</code> - сертификат клиента</li>
<li><code>tls.keySecretRef</code> - приватный ключ</li>
<li><code>tls.caSecretRef</code> - CA сертификат</li>
</ul>
<h4 id="postgresql_3">PostgreSQL</h4>
<ul>
<li><code>connectionStringSecretRef</code> - строка подключения</li>
<li><code>tableSecretRef</code> - название таблицы</li>
</ul>
<h4 id="iceberg_3">Iceberg</h4>
<ul>
<li><code>restCatalogUrlSecretRef</code> - URL REST Catalog</li>
<li><code>namespaceSecretRef</code> - namespace в каталоге</li>
<li><code>tableSecretRef</code> - название таблицы</li>
<li><code>tokenSecretRef</code> - токен аутентификации</li>
</ul>
<h4 id="rabbitmq_3">RabbitMQ</h4>
<ul>
<li><code>urlSecretRef</code> - URL подключения</li>
<li><code>queueSecretRef</code> - название очереди</li>
<li><code>exchangeSecretRef</code> - название exchange</li>
<li><code>routingKeySecretRef</code> - routing key</li>
</ul>
<h3 id="_8">Примеры использования</h3>
<h4 id="1-kafka-sasl">Пример 1: Kafka с SASL аутентификацией</h4>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Secret</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kafka-credentials</span>
<span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Opaque</span>
<span class="nt">stringData</span><span class="p">:</span>
<span class="w">  </span><span class="nt">brokers</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;kafka1:9092,kafka2:9092,kafka3:9092&quot;</span>
<span class="w">  </span><span class="nt">topic</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;input-topic&quot;</span>
<span class="w">  </span><span class="nt">consumerGroup</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;dataflow-group&quot;</span>
<span class="w">  </span><span class="nt">username</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;kafka-user&quot;</span>
<span class="w">  </span><span class="nt">password</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;kafka-password&quot;</span>
<span class="nn">---</span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dataflow.dataflow.io/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DataFlow</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kafka-example</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">source</span><span class="p">:</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kafka</span>
<span class="w">    </span><span class="nt">kafka</span><span class="p">:</span>
<span class="w">      </span><span class="nt">brokersSecretRef</span><span class="p">:</span>
<span class="w">        </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kafka-credentials</span>
<span class="w">        </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">brokers</span>
<span class="w">      </span><span class="nt">topicSecretRef</span><span class="p">:</span>
<span class="w">        </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kafka-credentials</span>
<span class="w">        </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">topic</span>
<span class="w">      </span><span class="nt">consumerGroupSecretRef</span><span class="p">:</span>
<span class="w">        </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kafka-credentials</span>
<span class="w">        </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">consumerGroup</span>
<span class="w">      </span><span class="nt">sasl</span><span class="p">:</span>
<span class="w">        </span><span class="nt">mechanism</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;scram-sha-256&quot;</span>
<span class="w">        </span><span class="nt">usernameSecretRef</span><span class="p">:</span>
<span class="w">          </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kafka-credentials</span>
<span class="w">          </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">username</span>
<span class="w">        </span><span class="nt">passwordSecretRef</span><span class="p">:</span>
<span class="w">          </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kafka-credentials</span>
<span class="w">          </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">password</span>
</code></pre></div>
<h4 id="2-postgresql-connection-string-secret">Пример 2: PostgreSQL с connection string из secret</h4>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Secret</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">postgres-credentials</span>
<span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Opaque</span>
<span class="nt">stringData</span><span class="p">:</span>
<span class="w">  </span><span class="nt">connectionString</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;postgres://user:password@postgres:5432/dbname?sslmode=disable&quot;</span>
<span class="w">  </span><span class="nt">table</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;output_table&quot;</span>
<span class="nn">---</span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dataflow.dataflow.io/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DataFlow</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">postgres-example</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">source</span><span class="p">:</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">postgresql</span>
<span class="w">    </span><span class="nt">postgresql</span><span class="p">:</span>
<span class="w">      </span><span class="nt">connectionStringSecretRef</span><span class="p">:</span>
<span class="w">        </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">postgres-credentials</span>
<span class="w">        </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">connectionString</span>
<span class="w">      </span><span class="nt">tableSecretRef</span><span class="p">:</span>
<span class="w">        </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">postgres-credentials</span>
<span class="w">        </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">table</span>
</code></pre></div>
<h4 id="3-kafka-postgresql-secrets">Пример 3: Kafka → PostgreSQL с secrets</h4>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Secret</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kafka-credentials</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Opaque</span>
<span class="nt">stringData</span><span class="p">:</span>
<span class="w">  </span><span class="nt">brokers</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;localhost:9092&quot;</span>
<span class="w">  </span><span class="nt">topic</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;input-topic&quot;</span>
<span class="w">  </span><span class="nt">consumerGroup</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;dataflow-group&quot;</span>
<span class="nn">---</span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Secret</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">postgres-credentials</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Opaque</span>
<span class="nt">stringData</span><span class="p">:</span>
<span class="w">  </span><span class="nt">connectionString</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;postgres://dataflow:dataflow@postgres:5432/dataflow?sslmode=disable&quot;</span>
<span class="w">  </span><span class="nt">table</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;output_table&quot;</span>
<span class="nn">---</span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dataflow.dataflow.io/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DataFlow</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kafka-to-postgres-secrets</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">source</span><span class="p">:</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kafka</span>
<span class="w">    </span><span class="nt">kafka</span><span class="p">:</span>
<span class="w">      </span><span class="nt">brokersSecretRef</span><span class="p">:</span>
<span class="w">        </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kafka-credentials</span>
<span class="w">        </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">brokers</span>
<span class="w">      </span><span class="nt">topicSecretRef</span><span class="p">:</span>
<span class="w">        </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kafka-credentials</span>
<span class="w">        </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">topic</span>
<span class="w">      </span><span class="nt">consumerGroupSecretRef</span><span class="p">:</span>
<span class="w">        </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kafka-credentials</span>
<span class="w">        </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">consumerGroup</span>
<span class="w">  </span><span class="nt">sink</span><span class="p">:</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">postgresql</span>
<span class="w">    </span><span class="nt">postgresql</span><span class="p">:</span>
<span class="w">      </span><span class="nt">connectionStringSecretRef</span><span class="p">:</span>
<span class="w">        </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">postgres-credentials</span>
<span class="w">        </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">connectionString</span>
<span class="w">      </span><span class="nt">tableSecretRef</span><span class="p">:</span>
<span class="w">        </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">postgres-credentials</span>
<span class="w">        </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">table</span>
</code></pre></div>
<h4 id="4-tls-secrets">Пример 4: TLS сертификаты из secrets</h4>
<p>Для TLS конфигурации оператор автоматически определяет, является ли значение из secret путем к файлу или содержимым сертификата. Если это содержимое, создается временный файл.</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Secret</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kafka-tls-certs</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Opaque</span>
<span class="nt">stringData</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># Содержимое CA сертификата</span>
<span class="w">  </span><span class="nt">ca.crt</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">    </span><span class="no">-----BEGIN CERTIFICATE-----</span>
<span class="w">    </span><span class="no">...</span>
<span class="w">    </span><span class="no">-----END CERTIFICATE-----</span>
<span class="w">  </span><span class="c1"># Содержимое клиентского сертификата</span>
<span class="w">  </span><span class="nt">client.crt</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">    </span><span class="no">-----BEGIN CERTIFICATE-----</span>
<span class="w">    </span><span class="no">...</span>
<span class="w">    </span><span class="no">-----END CERTIFICATE-----</span>
<span class="w">  </span><span class="c1"># Содержимое приватного ключа</span>
<span class="w">  </span><span class="nt">client.key</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">    </span><span class="no">-----BEGIN PRIVATE KEY-----</span>
<span class="w">    </span><span class="no">...</span>
<span class="w">    </span><span class="no">-----END PRIVATE KEY-----</span>
<span class="nn">---</span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dataflow.dataflow.io/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DataFlow</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kafka-tls-example</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">source</span><span class="p">:</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kafka</span>
<span class="w">    </span><span class="nt">kafka</span><span class="p">:</span>
<span class="w">      </span><span class="nt">brokers</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">secure-kafka:9093</span>
<span class="w">      </span><span class="nt">topic</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">secure-topic</span>
<span class="w">      </span><span class="nt">tls</span><span class="p">:</span>
<span class="w">        </span><span class="nt">caSecretRef</span><span class="p">:</span>
<span class="w">          </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kafka-tls-certs</span>
<span class="w">          </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ca.crt</span>
<span class="w">        </span><span class="nt">certSecretRef</span><span class="p">:</span>
<span class="w">          </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kafka-tls-certs</span>
<span class="w">          </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">client.crt</span>
<span class="w">        </span><span class="nt">keySecretRef</span><span class="p">:</span>
<span class="w">          </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kafka-tls-certs</span>
<span class="w">          </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">client.key</span>
</code></pre></div>
<h3 id="_9">Приоритет значений</h3>
<p>Если указаны и прямое значение, и <code>SecretRef</code>, приоритет имеет <code>SecretRef</code>. Значение из secret будет использовано вместо прямого значения.</p>
<h3 id="secrets-namespace">Secrets в разных namespace</h3>
<p>По умолчанию оператор ищет secrets в том же namespace, где находится DataFlow ресурс. Вы можете указать другой namespace:</p>
<div class="highlight"><pre><span></span><code><span class="nt">connectionStringSecretRef</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">postgres-credentials</span>
<span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">shared-secrets</span>
<span class="w">  </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">connectionString</span>
</code></pre></div>
<h3 id="_10">Безопасность</h3>
<ul>
<li><strong>RBAC</strong>: Оператору требуются права на чтение secrets (<code>get</code>, <code>list</code>, <code>watch</code>)</li>
<li><strong>Изоляция</strong>: Secrets должны быть в том же namespace или в namespace, к которому у оператора есть доступ</li>
<li><strong>Временные файлы</strong>: Для TLS сертификатов оператор создает временные файлы, которые автоматически удаляются</li>
</ul>
<h3 id="_11">Устранение неполадок</h3>
<h4 id="secret">Secret не найден</h4>
<div class="highlight"><pre><span></span><code><span class="c1"># Проверьте существование secret</span>
kubectl<span class="w"> </span>get<span class="w"> </span>secret<span class="w"> </span>&lt;secret-name&gt;<span class="w"> </span>-n<span class="w"> </span>&lt;namespace&gt;

<span class="c1"># Проверьте права оператора</span>
kubectl<span class="w"> </span>auth<span class="w"> </span>can-i<span class="w"> </span>get<span class="w"> </span>secrets<span class="w"> </span>--as<span class="o">=</span>system:serviceaccount:default:dataflow-operator
</code></pre></div>
<h4 id="secret_1">Ключ не найден в secret</h4>
<div class="highlight"><pre><span></span><code><span class="c1"># Проверьте ключи в secret</span>
kubectl<span class="w"> </span>get<span class="w"> </span>secret<span class="w"> </span>&lt;secret-name&gt;<span class="w"> </span>-n<span class="w"> </span>&lt;namespace&gt;<span class="w"> </span>-o<span class="w"> </span><span class="nv">jsonpath</span><span class="o">=</span><span class="s1">&#39;{.data}&#39;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>jq<span class="w"> </span><span class="s1">&#39;keys&#39;</span>
</code></pre></div>
<h4 id="secrets">Ошибка разрешения secrets</h4>
<p>Проверьте логи оператора:</p>
<div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>logs<span class="w"> </span>-l<span class="w"> </span>app.kubernetes.io/name<span class="o">=</span>dataflow-operator<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-i<span class="w"> </span>secret
</code></pre></div>
<p>Убедитесь, что:
1. Secret существует в указанном namespace
2. Указанный ключ существует в secret
3. У оператора есть права на чтение secrets</p>
<h2 id="_12">Рекомендации по производительности</h2>
<h3 id="kafka_4">Kafka</h3>
<ul>
<li>Используйте несколько брокеров для отказоустойчивости</li>
<li>Настройте правильный размер consumer group для параллельной обработки</li>
<li>Используйте батчи при записи для повышения throughput</li>
</ul>
<h3 id="postgresql_4">PostgreSQL</h3>
<ul>
<li>Увеличьте <code>batchSize</code> для приемника (рекомендуется 50-100)</li>
<li>Используйте индексы на часто запрашиваемых полях</li>
<li>Настройте <code>pollInterval</code> в зависимости от частоты обновления данных</li>
</ul>
<h3 id="rabbitmq_4">RabbitMQ</h3>
<ul>
<li>Используйте persistent queues для надежности</li>
<li>Настройте prefetch count для оптимизации производительности</li>
<li>Используйте exchanges для гибкой маршрутизации</li>
</ul>
<h3 id="iceberg_4">Iceberg</h3>
<ul>
<li>Используйте батчи для записи (автоматически, размер 10 сообщений)</li>
<li>Настройте правильный размер партиций для ваших данных</li>
<li>Используйте compaction для оптимизации чтения</li>
</ul>
<h2 id="_13">Устранение неполадок</h2>
<h3 id="_14">Проблемы с подключением</h3>
<ol>
<li>Проверьте доступность источника данных из кластера</li>
<li>Убедитесь, что credentials корректны</li>
<li>Проверьте сетевые политики Kubernetes</li>
<li>Для TLS проверьте сертификаты</li>
</ol>
<h3 id="_15">Проблемы с производительностью</h3>
<ol>
<li>Увеличьте размер батчей для приемников</li>
<li>Настройте правильный <code>pollInterval</code> для источников</li>
<li>Используйте несколько инстансов оператора для масштабирования</li>
<li>Мониторьте метрики обработки сообщений</li>
</ol>
<h3 id="_16">Логирование</h3>
<p>Включите детальное логирование для отладки:</p>
<div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>logs<span class="w"> </span>-l<span class="w"> </span>app.kubernetes.io/name<span class="o">=</span>dataflow-operator<span class="w"> </span>-f<span class="w"> </span>--tail<span class="o">=</span><span class="m">100</span>
</code></pre></div>
<p>Проверьте статус DataFlow ресурса:</p>
<div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>describe<span class="w"> </span>dataflow<span class="w"> </span>&lt;name&gt;
</code></pre></div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["navigation.tabs", "navigation.sections", "toc.integrate"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  </body>
</html>