apiVersion: dataflow.dataflow.io/v1
kind: DataFlow
metadata:
  name: router-example
spec:
  source:
    type: kafka
    kafka:
      brokers:
        - localhost:9092
      topic: events
      consumerGroup: dataflow-group
  sink:
    type: kafka
    kafka:
      brokers:
        - localhost:9092
      topic: default-events
  transformations:
    - type: router
      router:
        routes:
          - condition: "$.level == 'error'"
            sink:
              type: kafka
              kafka:
                brokers:
                  - localhost:9092
                topic: error-events
          - condition: "$.level == 'warning'"
            sink:
              type: postgresql
              postgresql:
                connectionString: "postgres://dataflow:dataflow@postgres:5432/dataflow?sslmode=disable"
                table: warnings



